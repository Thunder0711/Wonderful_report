<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <style>
        :root { --ac-mint: #A8D5BA; --ac-brown: #5B4636; --ac-blue: #5C7CFA; }
        body { font-family: -apple-system, sans-serif; display: flex; flex-direction: column; align-items: center; padding: 20px; color: var(--ac-brown); background: #fff; }
        h2 { font-size: 1.5rem; margin-bottom: 10px; }
        .hint { color: #666; margin-bottom: 30px; text-align: center; font-size: 0.9rem; }
        
        /* æ»‘å—å®¹å™¨ */
        .slider-container { width: 90%; position: relative; margin: 40px 0; }
        .labels { display: flex; justify-content: space-between; margin-bottom: 15px; color: #888; font-size: 0.9rem; }
        
        /* æ¸å˜è¿›åº¦æ¡ï¼šçº¢è‰²(ä½è½) -> é»„è‰²(ä¸­ç­‰) -> ç»¿è‰²(ç§¯æ) */
        input[type=range] { -webkit-appearance: none; width: 100%; height: 10px; border-radius: 5px; 
            background: linear-gradient(to right, #F44336, #FFC107, #4CAF50); outline: none; }
        
        input[type=range]::-webkit-slider-thumb { -webkit-appearance: none; width: 28px; height: 28px; 
            background: #fff; border: 3px solid var(--ac-blue); border-radius: 50%; cursor: pointer; box-shadow: 0 2px 8px rgba(0,0,0,0.15); }

        .value-display { font-size: 3.5rem; font-weight: bold; color: var(--ac-blue); margin: 15px 0; }
        .feedback { display: flex; align-items: center; gap: 12px; font-size: 1.3rem; font-weight: bold; background: #f8f9fa; padding: 10px 25px; border-radius: 30px; }
        .submit-btn { margin-top: 40px; width: 100%; max-width: 300px; padding: 16px; background: var(--ac-blue); 
            color: white; border: none; border-radius: 15px; font-size: 1.1rem; font-weight: bold; cursor: pointer; transition: opacity 0.2s; }
        .submit-btn:active { opacity: 0.8; }
    </style>
</head>
<body>
    <h2>å½“å‰å¿ƒç†çŠ¶æ€è¯„ä¼°</h2>
    <div class="hint">è¯·æ‹–åŠ¨æ»‘å—é€‰æ‹©æ‚¨æ­¤åˆ»çš„å¿ƒæƒ…çŠ¶æ€<br>0è¡¨ç¤ºéå¸¸ä½è½ï¼Œ10è¡¨ç¤ºéå¸¸ç§¯æ</div>

    <div class="slider-container">
        <div class="labels">
            <span>0 (ä½è½)</span>
            <span>5 (å¹³ç¨³)</span>
            <span>10 (ç§¯æ)</span>
        </div>
        <input type="range" id="moodSlider" min="0" max="10" value="5">
    </div>

    <div class="value-display" id="valText">5</div>
    <div class="feedback">
        <span id="emoji">ğŸ˜</span>
        <span id="status">æƒ…ç»ªå¹³ç¨³</span>
    </div>

    <button class="submit-btn" onclick="submit()">å®Œæˆè¯„ä¼°</button>

    <script>
        const slider = document.getElementById('moodSlider');
        const valText = document.getElementById('valText');
        const emoji = document.getElementById('emoji');
        const status = document.getElementById('status');

        // é…ç½®è¡¨ï¼šç°åœ¨ 0 æ˜¯æœ€å·®ï¼Œ10 æ˜¯æœ€å¥½
        const config = {
            0: { e: 'ğŸ˜­', s: 'æåº¦ä½è½' },
            1: { e: 'ğŸ˜«', s: 'éå¸¸ä½è½' },
            2: { e: 'ğŸ˜”', s: 'æ¯”è¾ƒä½è½' },
            3: { e: 'ğŸ˜Ÿ', s: 'æœ‰äº›ä¸å¼€å¿ƒ' },
            4: { e: 'ğŸ™', s: 'ç•¥å¾®ä½è½' },
            5: { e: 'ğŸ˜', s: 'æƒ…ç»ªå¹³ç¨³' },
            6: { e: 'ğŸ™‚', s: 'å¿ƒæƒ…è¿˜è¡Œ' },
            7: { e: 'ğŸ˜€', s: 'å¿ƒæƒ…ä¸é”™' },
            8: { e: 'ğŸ˜Š', s: 'æ¯”è¾ƒç§¯æ' },
            9: { e: 'ğŸ¥°', s: 'éå¸¸ç§¯æ' },
            10: { e: 'ğŸŒŸ', s: 'æåº¦ç§¯æ' }
        };

        slider.oninput = function() {
            const val = this.value;
            valText.innerText = val;
            emoji.innerText = config[val].e;
            status.innerText = config[val].s;
        };

        function submit() {
            const val = parseInt(slider.value);
            
            /* è®¡åˆ†é€»è¾‘ç¿»è½¬ (PHQ-9 é€»è¾‘)ï¼š
               ç§¯æåˆ† 9-10 -> æŠ‘éƒåˆ† 0 (å¥åº·)
               ç§¯æåˆ† 6-8  -> æŠ‘éƒåˆ† 1 (è½»åº¦)
               ç§¯æåˆ† 3-5  -> æŠ‘éƒåˆ† 2 (ä¸­åº¦)
               ç§¯æåˆ† 0-2  -> æŠ‘éƒåˆ† 3 (é‡åº¦)
            */
            let phqScore = 0;
            if (val <= 0) phqScore = 3;      // ç§¯æåˆ†æä½ = æŠ‘éƒåˆ†æé«˜
            else if (val <= 2) phqScore = 2;
            else if (val <= 4) phqScore = 1;
            else phqScore = 0;              // ç§¯æåˆ†æé«˜ = æŠ‘éƒåˆ†æä½

            // å›ä¼ æ•°æ®ç»™çˆ¶é¡µé¢ï¼ˆé˜¿æŸ´åŠ©æ‰‹ï¼‰
            window.parent.postMessage({
                type: 'experiment_result',
                eid: 'depression',
                score: phqScore,
                raw_value: val
            }, '*');
        }
    </script>
</body>
</html>