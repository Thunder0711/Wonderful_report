<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <style>
        :root { --ac-mint: #A8D5BA; --ac-brown: #5B4636; --ac-orange: #FFB37E; }
        body { font-family: -apple-system, sans-serif; display: flex; flex-direction: column; align-items: center; padding: 20px; color: var(--ac-brown); background: #fff; }
        h2 { font-size: 1.5rem; margin-bottom: 10px; }
        .hint { color: #666; margin-bottom: 30px; text-align: center; font-size: 0.9rem; }
        
        /* æ»‘å—å®¹å™¨ */
        .slider-container { width: 90%; position: relative; margin: 40px 0; }
        .labels { display: flex; justify-content: space-between; margin-bottom: 15px; color: #888; font-size: 0.9rem; }
        
        /* æ¸å˜è¿›åº¦æ¡ï¼šç»¿è‰²(æ”¾æ¾) -> é»„è‰²(ç´§å¼ ) -> æ©™çº¢è‰²(ç„¦è™‘) */
        input[type=range] { -webkit-appearance: none; width: 100%; height: 10px; border-radius: 5px; 
            background: linear-gradient(to right, #4CAF50, #FFC107, #FF5722); outline: none; }
        
        input[type=range]::-webkit-slider-thumb { -webkit-appearance: none; width: 28px; height: 28px; 
            background: #fff; border: 3px solid var(--ac-orange); border-radius: 50%; cursor: pointer; box-shadow: 0 2px 8px rgba(0,0,0,0.15); }

        .value-display { font-size: 3.5rem; font-weight: bold; color: var(--ac-orange); margin: 15px 0; }
        .feedback { display: flex; align-items: center; gap: 12px; font-size: 1.3rem; font-weight: bold; background: #fdf5f0; padding: 10px 25px; border-radius: 30px; }
        .submit-btn { margin-top: 40px; width: 100%; max-width: 300px; padding: 16px; background: var(--ac-orange); 
            color: white; border: none; border-radius: 15px; font-size: 1.1rem; font-weight: bold; cursor: pointer; transition: opacity 0.2s; }
        .submit-btn:active { opacity: 0.8; }
    </style>
</head>
<body>
    <h2>å½“å‰ç„¦è™‘ç¨‹åº¦è¯„ä¼°</h2>
    <div class="hint">è¯·æ‹–åŠ¨æ»‘å—é€‰æ‹©æ‚¨æ­¤åˆ»çš„å†…å¿ƒæ„Ÿå—<br>0è¡¨ç¤ºå†…å¿ƒå¹³é™ï¼Œ10è¡¨ç¤ºæåº¦ç„¦è™‘</div>

    <div class="slider-container">
        <div class="labels">
            <span>0 (æ”¾æ¾)</span>
            <span>5 (ç´§å¼ )</span>
            <span>10 (æƒŠæ)</span>
        </div>
        <input type="range" id="anxietySlider" min="0" max="10" value="0">
    </div>

    <div class="value-display" id="valText">0</div>
    <div class="feedback">
        <span id="emoji">ğŸ˜Œ</span>
        <span id="status">å†…å¿ƒå¹³é™</span>
    </div>

    <button class="submit-btn" onclick="submit()">å®Œæˆè¯„ä¼°</button>

    <script>
        const slider = document.getElementById('anxietySlider');
        const valText = document.getElementById('valText');
        const emoji = document.getElementById('emoji');
        const status = document.getElementById('status');

        // ç„¦è™‘é…ç½®è¡¨ï¼š0 æ˜¯æœ€è½»æ¾ï¼Œ10 æ˜¯æœ€ç„¦è™‘
        const config = {
            0: { e: 'ğŸ˜Œ', s: 'å†…å¿ƒå¹³é™' },
            1: { e: 'ğŸ˜Š', s: 'çŠ¶æ€è½»æ¾' },
            2: { e: 'ğŸ™‚', s: 'åŸºæœ¬æ”¾æ¾' },
            3: { e: 'ğŸ˜', s: 'å¾®æœ‰å‹åŠ›' },
            4: { e: 'ğŸ¤¨', s: 'å¼€å§‹ç´§å¼ ' },
            5: { e: 'ğŸ˜Ÿ', s: 'æ„Ÿåˆ°ä¸å®‰' },
            6: { e: 'ğŸ˜°', s: 'æ¯”è¾ƒç„¦è™‘' },
            7: { e: 'ğŸ˜¨', s: 'å¿ƒç¥ä¸å®' },
            8: { e: 'ğŸ˜§', s: 'éå¸¸ç„¦è™‘' },
            9: { e: 'ğŸ˜±', s: 'æåº¦ç„¦è™‘' },
            10: { e: 'ğŸ˜«', s: 'æƒŠæçŠ¶æ€' }
        };

        slider.oninput = function() {
            const val = this.value;
            valText.innerText = val;
            emoji.innerText = config[val].e;
            status.innerText = config[val].s;
        };

        function submit() {
            const val = parseInt(slider.value);
            
            /* è®¡åˆ†é€»è¾‘ (GAD-7 é£æ ¼)ï¼š
               åˆ†æ•°è¶Šé«˜ï¼Œç„¦è™‘å¾—åˆ†è¶Šé«˜
               0-2 ç§¯æåˆ† -> 0 (æ— ç„¦è™‘)
               3-5 ç§¯æåˆ† -> 1 (è½»åº¦)
               6-8 ç§¯æåˆ† -> 2 (ä¸­åº¦)
               9-10 ç§¯æåˆ† -> 3 (é‡åº¦)
            */
            let anxietyScore = 0;
            if (val <= 2) anxietyScore = 0;
            else if (val <= 5) anxietyScore = 1;
            else if (val <= 8) anxietyScore = 2;
            else anxietyScore = 3;

            // å›ä¼ æ•°æ®ç»™çˆ¶é¡µé¢ï¼ˆé˜¿æŸ´åŠ©æ‰‹ï¼‰ï¼Œæ³¨æ„ eid æ”¹ä¸ºäº† 'anxiety'
            window.parent.postMessage({
                type: 'experiment_result',
                eid: 'anxiety',
                score: anxietyScore,
                raw_value: val
            }, '*');
        }
    </script>
</body>
</html>